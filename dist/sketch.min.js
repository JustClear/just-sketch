(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.sketch=b()})("undefined"==typeof self?this:self,function(){"use strict";function a(a,b){function c(){e++,e==a.length&&b(d)}var d=[],e=0;a="object"==typeof a?a:[a],0===a.length&&b(d),a.map(function(a){var b=new Image;b.src=a,b.crossOrigin="*",b.addEventListener("load",c),b.addEventListener("error",c),d.push(b)})}function b(){for(var a=arguments.length,c=Array(a);a--;)c[a]=arguments[a];var d;return this instanceof b?void(d=this).init.apply(d,arguments):new(Function.prototype.bind.apply(b,[null].concat(c)))}return b.prototype.init=function(){var a=arguments[0],b=arguments[1];"number"==typeof a&&"number"==typeof b&&(this.width=a,this.height=b),this.symbols=[],this.catch=function(){}},b.prototype.initCanvas=function(a,b){return this.canvas=document.createElement("canvas"),this.canvas.width=a,this.canvas.height=b,this.ctx=this.canvas.getContext("2d"),this.ctx},b.prototype.import=function(a){return"string"==typeof a?this.background=a:console.log(".import(): import unknown type."),this},b.prototype.join=function(a,b){return void 0===a&&(a=""),void 0===b&&(b={}),"string"==typeof a?(b.image=a,this.symbols.push(b)):console.log(".join(): join unknown type."),this},b.prototype.rect=function(a){return void 0===a&&(a={}),a.type="rect",this.symbols.push(a),this},b.prototype.export=function(c){var d=this;return void 0===c&&(c=function(){}),a(this.background,function(e){var f=e[0];d.naturalRatio=f.naturalHeight/f.naturalWidth,d.width=d.width||f.naturalWidth,d.height=d.height||f.naturalHeight,d.initCanvas(d.width,d.height),d.ctx.drawImage(f,0,0,d.width,d.width*d.naturalRatio),a(d.symbols.map(function(a){return a.image||""}),function(a){a.map(function(a,b){var c=d.symbols[b],e=c.top;void 0===e&&(e=0);var f=c.right;void 0===f&&(f=0);var g=c.bottom;void 0===g&&(g=0);var h=c.left;void 0===h&&(h=0);var i,j,k,l;c.ratio=a.naturalHeight/a.naturalWidth,c.width&&null==c.height?(i=c.width,j=i*c.ratio):c.height&&null==c.width?(j=c.height,i=j/c.ratio):c.width&&c.height?(i=c.width,j=c.height):null==c.height&&null==c.width?(i=a.naturalWidth,j=a.naturalHeight):console.log("joined symbol size error"),0!==h&&0!==e?(k=h,l=e):0!==h&&0!==g?(k=h,l=d.height-(j+g)):0!==f&&0!==e?(k=d.width-(i+f),l=e):0!==f&&0!==g?(k=d.width-(i+f),l=d.height-(j+g)):console.log("symbol position error: only adjacent sides position are accepted"),i=i||0,j=j||0,k=k||0,l=l||0,"rect"==c.type?(c.backgroundColor&&(d.ctx.fillStyle=c.backgroundColor||"#000",d.ctx.fillRect(k+c.borderWidth,l+c.borderWidth,i,j)),c.borderWidth&&(d.ctx.beginPath(),d.ctx.lineWidth=c.borderWidth,d.ctx.strokeStyle=c.borderColor||"#000",d.ctx.rect(k+c.borderWidth,l+c.borderWidth,i,j),d.ctx.stroke())):d.ctx.drawImage(a,0,0,a.naturalWidth,a.naturalHeight,k,l,i,j)});try{c(d.canvas.toDataURL("image/"+(b.imageType||"jpeg")),d.ctx,d.canvas)}catch(a){setTimeout(function(){return d.catch(a)},0)}})}),this},b});
//# sourceMappingURL=sketch.min.js.map
